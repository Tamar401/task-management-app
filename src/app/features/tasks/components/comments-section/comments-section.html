<div class="comments-wrapper">
  <div class="comments-header">
    <mat-icon>forum</mat-icon>
    <h3>Comments</h3>
    <span class="badge">{{ comments().length }}</span>
  </div>

  <!-- Comments List -->
  <div class="comments-container">
    @if (loading()) {
      <div class="loading-state">
        <mat-icon>hourglass_empty</mat-icon>
        <p>Loading comments...</p>
      </div>
    } @else {
      @if (comments.length > 0) {
        <div class="comments-list">
          @for (comment of comments(); track comment.id) {
            <div class="comment-bubble">
              <div class="comment-avatar">
                <mat-icon>account_circle</mat-icon>
              </div>
              <div class="comment-body">
                <div class="comment-meta">
                  <span class="author-name">{{ comment.userName || 'Anonymous User' }}</span>
                  <span class="comment-time">{{ comment.createdAt | date: 'dd/MM/yy HH:mm' }}</span>
                </div>
                <div class="comment-text">
                  {{ comment.body }}
                </div>
              </div>
            </div>
          }
        </div>
      } @else {
        <div class="empty-state">
          <mat-icon>chat_bubble_outline</mat-icon>
          <p>No comments yet</p>
          <span>Be the first to comment!</span>
        </div>
      }
    }
  </div>

  <!-- Add Comment Form -->
  <div class="comment-input-container">
    <form [formGroup]="commentForm" (ngSubmit)="onSubmit()">
      <div class="input-wrapper">
        <textarea 
          formControlName="content"
          placeholder="Write a comment..."
          rows="1"
          (input)="autoResize($event)"
          class="comment-input"></textarea>
        <button 
          mat-icon-button 
          type="submit" 
          class="send-button"
          [disabled]="submitting() || commentForm.invalid">
          @if (submitting()) {
            <mat-icon class="spinning">hourglass_empty</mat-icon>
          } @else {
            <mat-icon>send</mat-icon>
          }
        </button>
      </div>
      @if (commentForm.controls.content.touched && commentForm.controls.content.hasError('required')) {
        <div class="error-message">Please enter comment content</div>
      }
    </form>
  </div>
</div>